<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Various information about engineering and computing things. Just tid-bits from an enthusiast"><meta name=author content="Brian Sidebotham"><link href=https://www.valvers.com/open-software/raspberry-pi/bare-metal-programming-in-c-part-1/ rel=canonical><link href=../bare-metal-programming-in-c-firmware/ rel=prev><link href=../bare-metal-programming-in-c-part-2/ rel=next><link rel=icon href=../../../assets/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.12"><title>BMC Part 1 - Getting Started - valvers.com</title><link rel=stylesheet href=../../../assets/stylesheets/main.0d440cfe.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.2505c338.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#bmc-part-1-getting-started class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=valvers.com class="md-header__button md-logo" aria-label=valvers.com data-md-component=logo> <img src=https://www.gravatar.com/avatar/8db3007cd3103d9ff42e90cc95dc7213 alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> valvers.com </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> BMC Part 1 - Getting Started </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/valvers/valvers.website.src title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../denford-orac/ class=md-tabs__link> Denford orac </a> </li> <li class=md-tabs__item> <a href=../../../engineering/ class=md-tabs__link> Engineering </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Open software </a> </li> <li class=md-tabs__item> <a href=../../../random/ class=md-tabs__link> Random </a> </li> <li class=md-tabs__item> <a href=../../../v6manta/ class=md-tabs__link> V6manta </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=valvers.com class="md-nav__button md-logo" aria-label=valvers.com data-md-component=logo> <img src=https://www.gravatar.com/avatar/8db3007cd3103d9ff42e90cc95dc7213 alt=logo> </a> valvers.com </label> <div class=md-nav__source> <a href=https://github.com/valvers/valvers.website.src title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__link--index "> <a href=../../../denford-orac/ >Denford orac</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Denford orac </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../denford-orac/2009-04-06-my-denford-orac/ class=md-nav__link> 2009 04 06 my denford orac </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-02-17-uprated-spindle-motor/ class=md-nav__link> 2012 02 17 uprated spindle motor </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-03-22-gathering-some-information/ class=md-nav__link> 2012 03 22 gathering some information </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-09-27-750w-motor-sourced/ class=md-nav__link> 2012 09 27 750w motor sourced </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-01-motor-doesnt-fit/ class=md-nav__link> 2012 10 01 motor doesnt fit </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-10-drill-head-disassembly/ class=md-nav__link> 2012 10 10 drill head disassembly </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-13-more-quill-dismantling/ class=md-nav__link> 2012 10 13 more quill dismantling </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-17-drill-spindle-is-apart/ class=md-nav__link> 2012 10 17 drill spindle is apart </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-29-removing-electrical-cabinet/ class=md-nav__link> 2012 10 29 removing electrical cabinet </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-10-31-tested-the-drill-head-above-the-lathe/ class=md-nav__link> 2012 10 31 tested the drill head above the lathe </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2012-11-02-rebuild-of-an-orac/ class=md-nav__link> 2012 11 02 rebuild of an orac </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2013-03-13-new-motor-fitted/ class=md-nav__link> 2013 03 13 new motor fitted </a> </li> <li class=md-nav__item> <a href=../../../denford-orac/2020-06-28-denford-orac-machinekit-controller/ class=md-nav__link> Denford Orac Machinekit Controller </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../../engineering/ >Engineering</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Engineering </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../engineering/an-and-jic-fittings/ class=md-nav__link> AN and JIC Fittings </a> </li> <li class=md-nav__item> <a href=../../../engineering/bolt-dimensions/ class=md-nav__link> Bolt Dimensions </a> </li> <li class=md-nav__item> <a href=../../../engineering/linuxcnc/ class=md-nav__link> LinuxCNC </a> </li> <li class=md-nav__item> <a href=../../../engineering/making-a-cyr-wheel/ class=md-nav__link> Making a Cyr Wheel </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../ >Open software</a> <label for=__nav_4> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Open software </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../android-car-dash/ class=md-nav__link> Android car dash </a> </li> <li class=md-nav__item> <a href=../../logging-with-gcc/ class=md-nav__link> Logging with gcc </a> </li> <li class=md-nav__item> <a href=../../posix-shell-scripting/ class=md-nav__link> Posix Shell Scripting </a> </li> <li class=md-nav__item> <a href=../../rpi-cm4-linuxcnc/ class=md-nav__link> RPI CM4 Linux CNC </a> </li> <li class=md-nav__item> <a href=../../working-with-the-screen-command/ class=md-nav__link> Working with the Screen Command </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7 id=__nav_4_7_label tabindex=0> Arduino <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Arduino </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../arduino/esp32-mqtt-tutorial/ class=md-nav__link> ESP32 MQTT Tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_8> <label class=md-nav__link for=__nav_4_8 id=__nav_4_8_label tabindex=0> Aws <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_4_8> <span class="md-nav__icon md-icon"></span> Aws </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../aws/aws-lambda-getting-started/ class=md-nav__link> AWS Lambda Getting Started </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_9> <label class=md-nav__link for=__nav_4_9 id=__nav_4_9_label tabindex=0> Gcc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_9_label aria-expanded=false> <label class=md-nav__title for=__nav_4_9> <span class="md-nav__icon md-icon"></span> Gcc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../gcc/weak-function-attributes/ class=md-nav__link> Weak Function Attributes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_10> <label class=md-nav__link for=__nav_4_10 id=__nav_4_10_label tabindex=0> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_10_label aria-expanded=false> <label class=md-nav__title for=__nav_4_10> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../python/pylab/ class=md-nav__link> Pylab </a> </li> <li class=md-nav__item> <a href=../../python/the-lethality-of-default-arguments-in-python/ class=md-nav__link> The Lethality of Default Arguments in Python </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11 checked> <label class=md-nav__link for=__nav_4_11 id=__nav_4_11_label tabindex=0> Raspberry pi <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=true> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> Raspberry pi </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-card/ class=md-nav__link> BMC Card Scripts </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-compiler/ class=md-nav__link> BMC Compiler </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-firmware/ class=md-nav__link> BMC Firmware </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> BMC Part 1 - Getting Started <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> BMC Part 1 - Getting Started </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#todo class=md-nav__link> TODO </a> </li> <li class=md-nav__item> <a href=#compatibility class=md-nav__link> Compatibility </a> </li> <li class=md-nav__item> <a href=#cross-compiling-for-the-raspberry-pi-bcm283567bcm23711 class=md-nav__link> Cross Compiling for the Raspberry Pi (BCM2835/6/7/BCM23711) </a> <nav class=md-nav aria-label="Cross Compiling for the Raspberry Pi (BCM2835/6/7/BCM23711)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compiler-version class=md-nav__link> Compiler Version </a> <nav class=md-nav aria-label="Compiler Version"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rpi1-compiler-flags class=md-nav__link> RPI1 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi2-compiler-flags class=md-nav__link> RPI2 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi3-compiler-flags class=md-nav__link> RPI3 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi4-compiler-flags class=md-nav__link> RPI4 Compiler Flags </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-to-know-the-compiler-and-linker class=md-nav__link> Getting to know the Compiler and Linker </a> <nav class=md-nav aria-label="Getting to know the Compiler and Linker"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#github class=md-nav__link> Github </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#part-1armc-00 class=md-nav__link> part-1/armc-00 </a> <nav class=md-nav aria-label=part-1/armc-00> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compiling class=md-nav__link> Compiling </a> <nav class=md-nav aria-label=Compiling> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rpi0-pizero-and-rpi1 class=md-nav__link> RPI0 (PiZero) and RPI1 </a> </li> <li class=md-nav__item> <a href=#rpi2 class=md-nav__link> RPI2 </a> </li> <li class=md-nav__item> <a href=#rpi3 class=md-nav__link> RPI3 </a> </li> <li class=md-nav__item> <a href=#rpi4 class=md-nav__link> RPI4 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-to-know-the-processor class=md-nav__link> Getting to Know the Processor </a> <nav class=md-nav aria-label="Getting to Know the Processor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#raspberry-pi-boot-process class=md-nav__link> Raspberry-Pi Boot Process </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#visual-output-and-running-code class=md-nav__link> Visual Output and Running Code </a> <nav class=md-nav aria-label="Visual Output and Running Code"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a-quick-note-about-the-elf-format class=md-nav__link> A quick note about the ELF format </a> </li> <li class=md-nav__item> <a href=#back-to-our-example class=md-nav__link> Back to our example </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#generating-sd-cards class=md-nav__link> Generating SD Cards </a> </li> <li class=md-nav__item> <a href=#provided-binaries class=md-nav__link> Provided Binaries </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-part-2/ class=md-nav__link> BMC Part 2 - The C Runtime </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-part-3/ class=md-nav__link> BMC Part 3 - CMake Build System </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-part-4/ class=md-nav__link> BMC Part 4 - Interrupts </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c-part-5/ class=md-nav__link> Part 5 - Graphics (Basic) </a> </li> <li class=md-nav__item> <a href=../bare-metal-programming-in-c/ class=md-nav__link> Raspberry-Pi Bare Metal Tutorial </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_12> <label class=md-nav__link for=__nav_4_12 id=__nav_4_12_label tabindex=0> Saltstack <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_12_label aria-expanded=false> <label class=md-nav__title for=__nav_4_12> <span class="md-nav__icon md-icon"></span> Saltstack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../saltstack/building-a-centos8-salt-master/ class=md-nav__link> Building a CentOS8 Salt Master </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_13> <label class=md-nav__link for=__nav_4_13 id=__nav_4_13_label tabindex=0> Webstacks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_13_label aria-expanded=false> <label class=md-nav__title for=__nav_4_13> <span class="md-nav__icon md-icon"></span> Webstacks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../webstacks/using-reactjs-and-bulma/ class=md-nav__link> Using ReactJS and Bulma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__link--index "> <a href=../../../random/ >Random</a> <label for=__nav_5> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Random </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../random/mortgage/ class=md-nav__link> Mortgage </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__link--index "> <a href=../../../v6manta/ >V6manta</a> <label for=__nav_6> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> V6manta </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> 2003 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> 2003 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-07-28-/ class=md-nav__link> 2003 07 28 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-07-28-brought-a-1.8s-berlinetta/ class=md-nav__link> 2003 07 28 brought a 1.8s berlinetta </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-07-28-stage-rally-opel-manta/ class=md-nav__link> 2003 07 28 stage rally opel manta </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-08-12-/ class=md-nav__link> 2003 08 12 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-08-13-/ class=md-nav__link> 2003 08 13 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-08-23-/ class=md-nav__link> 2003 08 23 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-09-11-/ class=md-nav__link> 2003 09 11 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-09-28-/ class=md-nav__link> 2003 09 28 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-10-07-/ class=md-nav__link> 2003 10 07 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-10-09-/ class=md-nav__link> 2003 10 09 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-11-04-/ class=md-nav__link> 2003 11 04 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2003/2003-12-16-/ class=md-nav__link> 2003 12 16 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> 2004 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> 2004 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-01-06-/ class=md-nav__link> 2004 01 06 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-01-07-/ class=md-nav__link> 2004 01 07 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-01-26-/ class=md-nav__link> 2004 01 26 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-01-29-/ class=md-nav__link> 2004 01 29 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-02-09-/ class=md-nav__link> 2004 02 09 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-02-13-/ class=md-nav__link> 2004 02 13 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-02-19-/ class=md-nav__link> 2004 02 19 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-04-20-finally-got-around-to-the-manta/ class=md-nav__link> 2004 04 20 finally got around to the manta </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-06-17-/ class=md-nav__link> 2004 06 17 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-06-18-/ class=md-nav__link> 2004 06 18 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-06-21-/ class=md-nav__link> 2004 06 21 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-07-26-/ class=md-nav__link> 2004 07 26 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-08-09-/ class=md-nav__link> 2004 08 09 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-08-10-/ class=md-nav__link> 2004 08 10 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-09-03-/ class=md-nav__link> 2004 09 03 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-09-27-/ class=md-nav__link> 2004 09 27 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-07-/ class=md-nav__link> 2004 10 07 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-08-/ class=md-nav__link> 2004 10 08 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-11-/ class=md-nav__link> 2004 10 11 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-13-/ class=md-nav__link> 2004 10 13 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-15-/ class=md-nav__link> 2004 10 15 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-18-/ class=md-nav__link> 2004 10 18 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-21-/ class=md-nav__link> 2004 10 21 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-22-/ class=md-nav__link> 2004 10 22 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-10-29-/ class=md-nav__link> 2004 10 29 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-11-01-/ class=md-nav__link> 2004 11 01 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2004/2004-12-10-were-back/ class=md-nav__link> 2004 12 10 were back </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> 2005 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> 2005 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-05-16-/ class=md-nav__link> 2005 05 16 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-08-04-done-something/ class=md-nav__link> 2005 08 04 done something </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-08-08-/ class=md-nav__link> 2005 08 08 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-08-10-/ class=md-nav__link> 2005 08 10 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-08-25-/ class=md-nav__link> 2005 08 25 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-08-31-/ class=md-nav__link> 2005 08 31 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-09-05-/ class=md-nav__link> 2005 09 05 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-09-19-/ class=md-nav__link> 2005 09 19 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-09-22-/ class=md-nav__link> 2005 09 22 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-09-23-/ class=md-nav__link> 2005 09 23 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-11-01-/ class=md-nav__link> 2005 11 01 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2005/2005-11-03-/ class=md-nav__link> 2005 11 03 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_5> <label class=md-nav__link for=__nav_6_5 id=__nav_6_5_label tabindex=0> 2007 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> 2007 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-10-20-/ class=md-nav__link> 2007 10 20 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-10-20-perspex-windows/ class=md-nav__link> 2007 10 20 perspex windows </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-11-13-getting-it-ready-to-paint.../ class=md-nav__link> 2007 11 13 getting it ready to paint... </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-11-21-almost-started-painting/ class=md-nav__link> 2007 11 21 almost started painting </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-11-28-underneath-is-complete/ class=md-nav__link> 2007 11 28 underneath is complete </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2007/2007-12-04-painting-the-inside-and-engine-bay/ class=md-nav__link> 2007 12 04 painting the inside and engine bay </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_6> <label class=md-nav__link for=__nav_6_6 id=__nav_6_6_label tabindex=0> 2008 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_6> <span class="md-nav__icon md-icon"></span> 2008 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-01-14-painting-the-shell-orange/ class=md-nav__link> 2008 01 14 painting the shell orange </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-01-16-out-of-the-booth/ class=md-nav__link> 2008 01 16 out of the booth </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-01-23-rear-axle-trial-fitting/ class=md-nav__link> 2008 01 23 rear axle trial fitting </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-02-24-painted-the-nextel-and-checked-for-wheel-clearance/ class=md-nav__link> 2008 02 24 painted the nextel and checked for wheel clearance </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-03-15-front-suspension-build/ class=md-nav__link> 2008 03 15 front suspension build </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-03-19-suspension-bushes-are-always-wrong/ class=md-nav__link> 2008 03 19 suspension bushes are always wrong </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-03-22-diff-bearings-need-replacing/ class=md-nav__link> 2008 03 22 diff bearings need replacing </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-04-08-fitted-the-rear-windows-and-steering-column/ class=md-nav__link> 2008 04 08 fitted the rear windows and steering column </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-04-12-shimmed-up-the-diff%2C-and-fitted-the-clocks/ class=md-nav__link> 2008 04 12 shimmed up the diff, and fitted the clocks </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-04-16-rebuilt-the-gearbox-so-i-get-gear-selection/ class=md-nav__link> 2008 04 16 rebuilt the gearbox so i get gear selection </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-07-08-its-on-its-wheels-at-last/ class=md-nav__link> 2008 07 08 its on its wheels at last </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-09-02-rebuilt-oil-pump--started-headwork/ class=md-nav__link> 2008 09 02 rebuilt oil pump started headwork </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-09-04-some-more-headwork/ class=md-nav__link> 2008 09 04 some more headwork </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-09-25-even-more-headwork/ class=md-nav__link> 2008 09 25 even more headwork </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-11-09-engine--transmission-fitted/ class=md-nav__link> 2008 11 09 engine transmission fitted </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-11-16-engine--gearbox-mounted--steering-column-fitted/ class=md-nav__link> 2008 11 16 engine gearbox mounted steering column fitted </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2008/2008-12-14-stripping-the-x25xe-v6-bottom-end/ class=md-nav__link> 2008 12 14 stripping the x25xe v6 bottom end </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_7> <label class=md-nav__link for=__nav_6_7 id=__nav_6_7_label tabindex=0> 2009 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_7> <span class="md-nav__icon md-icon"></span> 2009 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2009/2009-06-24-making-the-dry-sump-pan/ class=md-nav__link> 2009 06 24 making the dry sump pan </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2009/2009-10-05-trialling-the-throttle-bodies--a-few-more-bits-painted/ class=md-nav__link> 2009 10 05 trialling the throttle bodies a few more bits painted </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2009/2009-12-18-flywheel-and-clutch/ class=md-nav__link> 2009 12 18 flywheel and clutch </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_8> <label class=md-nav__link for=__nav_6_8 id=__nav_6_8_label tabindex=0> 2010 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_8_label aria-expanded=false> <label class=md-nav__title for=__nav_6_8> <span class="md-nav__icon md-icon"></span> 2010 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-01-23-done-the-handbrake--sliders/ class=md-nav__link> 2010 01 23 done the handbrake sliders </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-01-27-started-building-the-v6-heads-up/ class=md-nav__link> 2010 01 27 started building the v6 heads up </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-01-30-picked-up-another-v6/ class=md-nav__link> 2010 01 30 picked up another v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-01-exhaust-manifolds/ class=md-nav__link> 2010 02 01 exhaust manifolds </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-02-starting-the-v6-build/ class=md-nav__link> 2010 02 02 starting the v6 build </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-03-cylinder-head-bolts-torque/ class=md-nav__link> 2010 02 03 cylinder head bolts torque </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-03-ordered-the-exhaust-manifold-flanges/ class=md-nav__link> 2010 02 03 ordered the exhaust manifold flanges </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-06-building-the-v6/ class=md-nav__link> 2010 02 06 building the v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-07-building-the-v6/ class=md-nav__link> 2010 02 07 building the v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-02-14-building-the-v6/ class=md-nav__link> 2010 02 14 building the v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-03-22-gearbox-sealed-and-release-bearing-fitted/ class=md-nav__link> 2010 03 22 gearbox sealed and release bearing fitted </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-03-started-on-the-manifolds/ class=md-nav__link> 2010 04 03 started on the manifolds </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-05-finished-a-manifold/ class=md-nav__link> 2010 04 05 finished a manifold </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-07-started-the-second-manifold/ class=md-nav__link> 2010 04 07 started the second manifold </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-11-need-a-todo-list/ class=md-nav__link> 2010 04 11 need a todo list </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-21-ticking-off-the-boxes/ class=md-nav__link> 2010 04 21 ticking off the boxes </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-04-26-nearly-finished-the-second-manifold/ class=md-nav__link> 2010 04 26 nearly finished the second manifold </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-05-09-got-the-car-rolling/ class=md-nav__link> 2010 05 09 got the car rolling </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-05-11-rolling-road-day/ class=md-nav__link> 2010 05 11 rolling road day </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-05-31-back-from-germany/ class=md-nav__link> 2010 05 31 back from germany </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-06-01-sumps-off/ class=md-nav__link> 2010 06 01 sumps off </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-06-06-done-most-of-the-bits-on-the-v6/ class=md-nav__link> 2010 06 06 done most of the bits on the v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-06-12-getting-ready-to-bolt-it-back-in/ class=md-nav__link> 2010 06 12 getting ready to bolt it back in </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-06-19-almost-ready-to-go-back-in/ class=md-nav__link> 2010 06 19 almost ready to go back in </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-09-22-lack-of-updates/ class=md-nav__link> 2010 09 22 lack of updates </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-09-26-few-little-bits/ class=md-nav__link> 2010 09 26 few little bits </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-10-09-v6-oil-problems..../ class=md-nav__link> 2010 10 09 v6 oil problems.... </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-10-12-starting-putting-the-engine-back-together/ class=md-nav__link> 2010 10 12 starting putting the engine back together </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-10-23-v6-is-broke/ class=md-nav__link> 2010 10 23 v6 is broke </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-10-24-stripping-the-v6/ class=md-nav__link> 2010 10 24 stripping the v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-10-25-v6-problem/ class=md-nav__link> 2010 10 25 v6 problem </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-11-03-picked-up-a-replacement-v6/ class=md-nav__link> 2010 11 03 picked up a replacement v6 </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2010/2010-12-12-been-busy-building/ class=md-nav__link> 2010 12 12 been busy building </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_9> <label class=md-nav__link for=__nav_6_9 id=__nav_6_9_label tabindex=0> 2011 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_9_label aria-expanded=false> <label class=md-nav__title for=__nav_6_9> <span class="md-nav__icon md-icon"></span> 2011 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-01-01-finally-driven-the-manta-again-today/ class=md-nav__link> 2011 01 01 finally driven the manta again today </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-03-13-fitting-some-new-seats/ class=md-nav__link> 2011 03 13 fitting some new seats </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-03-13-the-manta-got-mapped/ class=md-nav__link> 2011 03 13 the manta got mapped </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-03-25-went-to-brands-hatch/ class=md-nav__link> 2011 03 25 went to brands hatch </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-04-started-work-on-the-2011-rebuild/ class=md-nav__link> 2011 09 04 started work on the 2011 rebuild </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-10-built-some-more-of-the-frame/ class=md-nav__link> 2011 09 10 built some more of the frame </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-14-started-work-on-the-new-sump-pan/ class=md-nav__link> 2011 09 14 started work on the new sump pan </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-15-more-subframe-work/ class=md-nav__link> 2011 09 15 more subframe work </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-17-gearbox-back-together/ class=md-nav__link> 2011 09 17 gearbox back together </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-09-25-getting-ready-to-spray-the-engine-bay-again.../ class=md-nav__link> 2011 09 25 getting ready to spray the engine bay again... </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-10-16-moving-along-with-the-rebuild/ class=md-nav__link> 2011 10 16 moving along with the rebuild </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-10-18-painted-the-engine-bay/ class=md-nav__link> 2011 10 18 painted the engine bay </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2011/2011-11-15-dry-sump-work.../ class=md-nav__link> 2011 11 15 dry sump work... </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_10> <label class=md-nav__link for=__nav_6_10 id=__nav_6_10_label tabindex=0> 2012 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_10_label aria-expanded=false> <label class=md-nav__title for=__nav_6_10> <span class="md-nav__icon md-icon"></span> 2012 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-01-09-dry-sump-pan-is-welded/ class=md-nav__link> 2012 01 09 dry sump pan is welded </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-01-27-more-dry-sump-work/ class=md-nav__link> 2012 01 27 more dry sump work </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-02-21-engine-is-back-in.../ class=md-nav__link> 2012 02 21 engine is back in... </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-02-24-took-the-engine-back-out-again/ class=md-nav__link> 2012 02 24 took the engine back out again </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-02-27-engine-back-in-again/ class=md-nav__link> 2012 02 27 engine back in again </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-03-14-mostly-plumbed-back-in/ class=md-nav__link> 2012 03 14 mostly plumbed back in </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-04-04-started-her-up-again/ class=md-nav__link> 2012 04 04 started her up again </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-04-16-ready-for-a-test-drive/ class=md-nav__link> 2012 04 16 ready for a test drive </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-05-09-clutch-release-bearing-failure/ class=md-nav__link> 2012 05 09 clutch release bearing failure </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-05-17-stripping-the-t5-gearbox/ class=md-nav__link> 2012 05 17 stripping the t5 gearbox </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-10-13-rebuilt-the-gearbox/ class=md-nav__link> 2012 10 13 rebuilt the gearbox </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-11-11-finally-the-engines-back-in/ class=md-nav__link> 2012 11 11 finally the engines back in </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-11-14-nearly-back-together/ class=md-nav__link> 2012 11 14 nearly back together </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-11-25-the-finishing-touches/ class=md-nav__link> 2012 11 25 the finishing touches </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-11-28-finally-the-v6-manta-up-a-running-again/ class=md-nav__link> 2012 11 28 finally the v6 manta up a running again </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2012/2012-12-30-virtually-back-on-the-road/ class=md-nav__link> 2012 12 30 virtually back on the road </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_11> <label class=md-nav__link for=__nav_6_11 id=__nav_6_11_label tabindex=0> 2013 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_11_label aria-expanded=false> <label class=md-nav__title for=__nav_6_11> <span class="md-nav__icon md-icon"></span> 2013 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../v6manta/2013/2013-01-10-driven-the-manta-again/ class=md-nav__link> 2013 01 10 driven the manta again </a> </li> <li class=md-nav__item> <a href=../../../v6manta/2013/2013-01-15-had-a-great-blast-in-the-manta/ class=md-nav__link> 2013 01 15 had a great blast in the manta </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#todo class=md-nav__link> TODO </a> </li> <li class=md-nav__item> <a href=#compatibility class=md-nav__link> Compatibility </a> </li> <li class=md-nav__item> <a href=#cross-compiling-for-the-raspberry-pi-bcm283567bcm23711 class=md-nav__link> Cross Compiling for the Raspberry Pi (BCM2835/6/7/BCM23711) </a> <nav class=md-nav aria-label="Cross Compiling for the Raspberry Pi (BCM2835/6/7/BCM23711)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compiler-version class=md-nav__link> Compiler Version </a> <nav class=md-nav aria-label="Compiler Version"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rpi1-compiler-flags class=md-nav__link> RPI1 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi2-compiler-flags class=md-nav__link> RPI2 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi3-compiler-flags class=md-nav__link> RPI3 Compiler Flags </a> </li> <li class=md-nav__item> <a href=#rpi4-compiler-flags class=md-nav__link> RPI4 Compiler Flags </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-to-know-the-compiler-and-linker class=md-nav__link> Getting to know the Compiler and Linker </a> <nav class=md-nav aria-label="Getting to know the Compiler and Linker"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#github class=md-nav__link> Github </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#part-1armc-00 class=md-nav__link> part-1/armc-00 </a> <nav class=md-nav aria-label=part-1/armc-00> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compiling class=md-nav__link> Compiling </a> <nav class=md-nav aria-label=Compiling> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rpi0-pizero-and-rpi1 class=md-nav__link> RPI0 (PiZero) and RPI1 </a> </li> <li class=md-nav__item> <a href=#rpi2 class=md-nav__link> RPI2 </a> </li> <li class=md-nav__item> <a href=#rpi3 class=md-nav__link> RPI3 </a> </li> <li class=md-nav__item> <a href=#rpi4 class=md-nav__link> RPI4 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-to-know-the-processor class=md-nav__link> Getting to Know the Processor </a> <nav class=md-nav aria-label="Getting to Know the Processor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#raspberry-pi-boot-process class=md-nav__link> Raspberry-Pi Boot Process </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#visual-output-and-running-code class=md-nav__link> Visual Output and Running Code </a> <nav class=md-nav aria-label="Visual Output and Running Code"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a-quick-note-about-the-elf-format class=md-nav__link> A quick note about the ELF format </a> </li> <li class=md-nav__item> <a href=#back-to-our-example class=md-nav__link> Back to our example </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#generating-sd-cards class=md-nav__link> Generating SD Cards </a> </li> <li class=md-nav__item> <a href=#provided-binaries class=md-nav__link> Provided Binaries </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=bmc-part-1-getting-started>BMC Part 1 - Getting Started<a class=headerlink href=#bmc-part-1-getting-started title="Permanent link">&para;</a></h1> <p>Although the Raspberry-Pi comes with a good Linux distribution, the Pi is about software development, and sometimes we want a real-time system without an operating system. I decided it'd be great to do a tutorial outside of Linux to get to the resources of this great piece of hardware in a similar vein to the <a href=http://www.cl.cam.ac.uk/freshers/raspberrypi/tutorials/ >Cambridge University Tutorials</a> which are excellently written.</p> <p>However, they don't create an OS as purported and they stick with assembler rather than migrating to C. I will simply start with nothing but assembler to get us going, but switch to C as soon as possible.</p> <p><strong>The C compiler simply converts C syntax to assembler and then assembles this into executable code for us anyway.</strong></p> <p>I highly recommend going through the Cambridge University Raspberry Pi tutorials as they are excellent. If you want to learn a bit of assembler too, then definitely head off to there! These pages provide a similar experience, but with the additional of writing code in C and understanding the process behind that.</p> <h2 id=todo>TODO<a class=headerlink href=#todo title="Permanent link">&para;</a></h2> <ul> <li>Why is a card of 16MiB necessary when we're not using anywhere near that?</li> </ul> <h2 id=compatibility>Compatibility<a class=headerlink href=#compatibility title="Permanent link">&para;</a></h2> <p>There are quite a few versions of the RPi these days. This part of the tutorial supports the following models:</p> <ul> <li>RPi Model A</li> <li>RPi Model B</li> <li>RPi Zero</li> <li>RPi Zero W</li> <li>RPi Model B+</li> <li>RPi 2 Model B</li> <li>RPi 3 Model B</li> <li>RPi 4 Model B</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>It is not an error that the RPI 3 Model B+ is not included in this list. The ACK LED is only available through the mailbox interface (available from part-4 of the tutorial) and so cannot be used directly by the GPIO peripheral which we'll be using in this part of the tutorial.</p> </div> <h2 id=cross-compiling-for-the-raspberry-pi-bcm283567bcm23711>Cross Compiling for the Raspberry Pi (BCM2835/6/7/BCM23711)<a class=headerlink href=#cross-compiling-for-the-raspberry-pi-bcm283567bcm23711 title="Permanent link">&para;</a></h2> <p>ARM have now taken over the arm-gcc-embedded project and are provided the releases, so pop over to the <a href=https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads>ARM gcc downloads</a> section and pick up a toolchain.</p> <p>I've just grabbed 7.3.1 from the download page and I've locally installed it on my Linux machine to use with this tutorial.</p> <p>This is what I get when I run this on my command line having decompressed the archive:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>~/arm-tutorial-rpi/compiler/gcc-arm-none-eabi-7-2018-q2-update/bin<span class=w> </span>$<span class=w> </span>./arm-none-eabi-gcc<span class=w> </span>--version
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>arm-none-eabi-gcc<span class=w> </span><span class=o>(</span>GNU<span class=w> </span>Tools<span class=w> </span><span class=k>for</span><span class=w> </span>Arm<span class=w> </span>Embedded<span class=w> </span>Processors<span class=w> </span><span class=m>7</span>-2018-q2-update<span class=o>)</span><span class=w> </span><span class=m>7</span>.3.1<span class=w> </span><span class=m>20180622</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class=o>(</span>release<span class=o>)</span><span class=w> </span><span class=o>[</span>ARM/embedded-7-branch<span class=w> </span>revision<span class=w> </span><span class=m>261907</span><span class=o>]</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>Copyright<span class=w> </span><span class=o>(</span>C<span class=o>)</span><span class=w> </span><span class=m>2017</span><span class=w> </span>Free<span class=w> </span>Software<span class=w> </span>Foundation,<span class=w> </span>Inc.
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>This<span class=w> </span>is<span class=w> </span>free<span class=w> </span>software<span class=p>;</span><span class=w> </span>see<span class=w> </span>the<span class=w> </span><span class=nb>source</span><span class=w> </span><span class=k>for</span><span class=w> </span>copying<span class=w> </span>conditions.<span class=w>  </span>There<span class=w> </span>is<span class=w> </span>NO
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>warranty<span class=p>;</span><span class=w> </span>not<span class=w> </span>even<span class=w> </span><span class=k>for</span><span class=w> </span>MERCHANTABILITY<span class=w> </span>or<span class=w> </span>FITNESS<span class=w> </span>FOR<span class=w> </span>A<span class=w> </span>PARTICULAR<span class=w> </span>PURPOSE.
</code></pre></div> <p>Cool.</p> <p>You can use the <code>compiler/get_compiler.sh</code> script as a short-cut to get the compiler and the tutorial scripts will make use of it if you do.</p> <h3 id=compiler-version>Compiler Version<a class=headerlink href=#compiler-version title="Permanent link">&para;</a></h3> <p>Previously with a prior stab at this tutorial I always linked and recommended a fixed, known-working version of the compiler because everything then just worked out of the box. However, now I'm saying - just get the latest and then we can fix the tutorial as things break.</p> <blockquote> <p><strong>NOTE:</strong> The disassembly listing you get may vary slightly from those generated by the gcc version being used in this tutorial if you're using a different compiler version or option set.</p> </blockquote> <h4 id=rpi1-compiler-flags>RPI1 Compiler Flags<a class=headerlink href=#rpi1-compiler-flags title="Permanent link">&para;</a></h4> <p>The <a href=http://elinux.org/RPi_Software#ARM>eLinux page</a> gives us the optimal GCC settings for compiling code for the original Raspberry-Pi (V1):</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>-Ofast<span class=w> </span>-mfpu<span class=o>=</span>vfp<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span>-march<span class=o>=</span>armv6zk<span class=w> </span>-mtune<span class=o>=</span>arm1176jzf-s
</code></pre></div> <p>It is noted that -Ofast may cause problems with some compilations, so it is probably better that we stick with the more traditional -O2 optimisation setting. The other flags merely tell GCC what type of floating point unit we have, tell it to produce hard-floating point code (GCC can create software floating point support instead), and tells GCC what ARM processor architecture we have so that it can produce optimal and compatible assembly/machine code.</p> <h4 id=rpi2-compiler-flags>RPI2 Compiler Flags<a class=headerlink href=#rpi2-compiler-flags title="Permanent link">&para;</a></h4> <p>For the Raspberry-Pi 2 we know that the architecture is different. The ARM1176 from the original pi has been replaced by a quad core Cortex A7 processor. Therefore, in order to compile effectively for the Raspberry-Pi 2 we use a different set of compiler options:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>-O2<span class=w> </span>-mfpu<span class=o>=</span>neon-vfpv4<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span>-march<span class=o>=</span>armv7-a<span class=w> </span>-mtune<span class=o>=</span>cortex-a7
</code></pre></div> <p>You can see from the <a href=http://docs-api-peg.northeurope.cloudapp.azure.com/assets/ddi0464/f/DDI0464F_cortex_a7_mpcore_r0p5_trm.pdf>ARM specification of the Cortex A7</a> that it contains a VFPV4 (See section 1.2.1) floating point processor and a NEON engine. The settings are gleaned from the <a href=https://gcc.gnu.org/onlinedocs/gcc/ARM-Options.html>GCC ARM options</a> page.</p> <h4 id=rpi3-compiler-flags>RPI3 Compiler Flags<a class=headerlink href=#rpi3-compiler-flags title="Permanent link">&para;</a></h4> <p>Like this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>-O2<span class=w> </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span>-mcpu<span class=o>=</span>cortex-a53
</code></pre></div> <h4 id=rpi4-compiler-flags>RPI4 Compiler Flags<a class=headerlink href=#rpi4-compiler-flags title="Permanent link">&para;</a></h4> <p>From the Raspberry Pi Foundation page for the RPi4 we can glean some information from the <a href=https://www.raspberrypi.org/products/raspberry-pi-4-model-b/specifications/ >technical specifications</a> regarding what we need to do in order to compile code for the RPi4.</p> <p>All four processors are <code>A72</code>. From the ARM documentation we can see that these implement the <code>armv8-a</code> architecture. This is the same as the <code>A53</code>'s found in the RPi3 so we can go ahead and use the same <code>crypto-neon-fp-armv8</code> floating point unit option for the RPI4. This is detailed in the <a href=https://static.docs.arm.com/den0024/a/DEN0024A_v8_architecture_PG.pdf>v8 architecture programmers guide</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>-O2<span class=w> </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span>-mcpu<span class=o>=</span>cortex-a72
</code></pre></div> <p>The <a href=https://www.raspberrypi.org/documentation/hardware/raspberrypi/schematics/rpi_SCH_4b_4p0_reduced.pdf>schematics</a> you would think would be the place to get the ACT LED GPIO port number, but alas, they're so sparse they may as well not have bothered releasing them. <em>Seriously - what they've released is a joke</em>.</p> <p>Instead we get it from some of the <a href=https://github.com/raspberrypi/linux/blob/rpi-4.19.y/arch/arm/boot/dts/bcm2838-rpi-4-b.dts>device tree source code for the RPi4</a>.</p> <p>Also make sure you've got the latest firmware, <a href=https://github.com/raspberrypi/firmware/issues/1175>fixes are always being introduced!</a></p> <h2 id=getting-to-know-the-compiler-and-linker>Getting to know the Compiler and Linker<a class=headerlink href=#getting-to-know-the-compiler-and-linker title="Permanent link">&para;</a></h2> <p>In order to use a C compiler, we need to understand what the compiler does and what the linker does in order to generate executable code. The compiler converts C statements into assembler and performs optimisation of the assembly instructions. This is in-fact all the C compiler does!</p> <p>The C compiler then implicitly calls the assembler to assemble that file (usually a temporary) into an object file. This will have relocatable machine code in it along with symbol information for the linker to use. These days the C compiler pipes the assembly to the assembler so there is no intermediate file as creating files is a lot slower than passing data from one program to another through a pipe.</p> <p>The linker's job is to link everything into an executable file. The linker requires a linker script. The linker script tells the linker how to organise the various object files. The linker will resolve symbols to addresses when it has arranged all the objects according to the rules in the linker script.</p> <p>What we're getting close to here is that a C program isn't just the code we type. There are some fundamental things that must happen for C code to run. For example, some variables need to be initialised to certain values, and some variables need to be initialised to 0. This is all taken care of by an object file which is usually implicitly linked in by the linker because the linker script will include a reference to it. The object file is called crt0.o (C Run-Time zero)</p> <p>This code uses symbols that the linker can resolve to clear the start of the area where initialised variables starts and ends in order to zero this memory section. It generally sets up a stack pointer, and it always includes a call to <code>_main</code>. Here's an important note: symbols present in C code get prepended with an underscore in the generation of the assembler version of the code. So where the start of a C program is the main symbol, in assembler we need to refer to it as it's assembler version which is <code>_main</code>.</p> <h3 id=github>Github<a class=headerlink href=#github title="Permanent link">&para;</a></h3> <p>All of the source in the tutorials is available from the <a href=https://github.com/BrianSidebotham/arm-tutorial-rpi>Github repo</a>. So go clone or fork now so you have all the code to compile and modify as you work through the tutorials.</p> <blockquote> <p><code>git clone https://github.com/BrianSidebotham/arm-tutorial-rpi</code></p> </blockquote> <p>If you're on Windows - these day's I'll say, just get with the program and get yourself a Linux install. If you're entering the world of Raspberry Pi and/or embedded devices Linux is going to be your friend and will give you everything you need. This tutorial used to support both Linux and Windows, but I have no Windows installs left and so can't cover off Windows. If someone else takes that on, I'd fully support them in updating the tutorial - it's all on <a href=https://github.com/BrianSidebotham/arm-tutorial-rpi>Github</a>.</p> <p>Let's have a look at compiling one of the simplest programs that we can. Let's compile and link the following program (<code>part-1/armc-00</code>):</p> <h2 id=part-1armc-00>part-1/armc-00<a class=headerlink href=#part-1armc-00 title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>        </span><span class=k>while</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>        </span><span class=p>{</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <h3 id=compiling>Compiling<a class=headerlink href=#compiling title="Permanent link">&para;</a></h3> <p>In order to compile the code (I realise there's not much to that code!) we can use the <code>build.sh</code> script in the tutorial directory. Navigate to <code>part-1/armc-00</code> and run <code>./build.sh</code>. With no arguments this script will just show you what it expects in order to run.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>arm-tutorial-rpi/part-1/armc-00<span class=w> </span>$<span class=w> </span>./build.sh
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>usage:<span class=w> </span>build.sh<span class=w> </span>&lt;pi-model&gt;
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>       </span>pi-model<span class=w> </span>options:<span class=w> </span>rpi0,<span class=w> </span>rpi1,<span class=w> </span>rpi1bp,<span class=w> </span>rpi2,<span class=w> </span>rpi3,<span class=w> </span>rpi3bp,<span class=w> </span>rpi4
</code></pre></div> <p>As there are different compiler flags for the various RPI models, it's necessary to tell the script what RPI you have in order to use the correct flags to compile with.</p> <p>The V1 boards are fitted with the Broadcom BCM2835 (ARM1176) and the V2 board uses the BCM2836 (ARM Cortex A7). The RPI3 uses a Cortex-A53. Because of the processor differences, we use different build commands to build for the various RPI models.</p> <p>Let's have a look at what the compiler command lines look like for the various RPI models.</p> <p>Let's just concentrate on the RPI-specific options rather than including all the options here.</p> <h4 id=rpi0-pizero-and-rpi1>RPI0 (PiZero) and RPI1<a class=headerlink href=#rpi0-pizero-and-rpi1 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>arm-none-eabi-gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>    </span>-mfpu<span class=o>=</span>vfp<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span>-march<span class=o>=</span>armv6zk<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>    </span>-mtune<span class=o>=</span>arm1176jzf-s<span class=w> </span><span class=se>\</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span>main.c<span class=w> </span>-o<span class=w> </span>main.elf
</code></pre></div> <h4 id=rpi2>RPI2<a class=headerlink href=#rpi2 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>arm-none-eabi-gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>    </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=w>    </span>-mfpu<span class=o>=</span>neon-vfpv4<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>    </span>-march<span class=o>=</span>armv7-a<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>    </span>-mtune<span class=o>=</span>cortex-a7<span class=w> </span><span class=se>\</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>    </span>main.c<span class=w> </span>-o<span class=w> </span>main.elf
</code></pre></div> <h4 id=rpi3>RPI3<a class=headerlink href=#rpi3 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>arm-none-eabi-gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>    </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>    </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>    </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>    </span>-mcpu<span class=o>=</span>cortex-a53<span class=w> </span><span class=se>\</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>    </span>main.c<span class=w> </span>-o<span class=w> </span>main.elf
</code></pre></div> <h4 id=rpi4>RPI4<a class=headerlink href=#rpi4 title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>arm-none-eabi-gcc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>    </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>    </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>    </span>-mcpu<span class=o>=</span>cortex-a72<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span>main.c<span class=w> </span>-o<span class=w> </span>main.elf
</code></pre></div> <p><em>THIS IS EXPECTED TO FAIL</em>: Using the build script, let's compile the basic source code using the RPI specific options. Here, we compile for the RPI3. (I've shortened the output so it's easier to read on-screen).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>valvers-new/arm-tutorial-rpi/part-1/armc-00<span class=w> </span>$<span class=w> </span>./build.sh<span class=w> </span>rpi3
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>arm-none-eabi-gcc<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span>-mcpu<span class=o>=</span>cortex-a53<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span>armc-00.c<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>    </span>-o<span class=w> </span>kernel.armc-00.rpi3.elf
</code></pre></div> <p>GCC does successfully compile the source code (there are no C errors in it), but the linker fails with the following message:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>.../hard/libc.a<span class=o>(</span>lib_a-exit.o<span class=o>)</span>:<span class=w> </span>In<span class=w> </span><span class=k>function</span><span class=w> </span><span class=sb>`</span>exit<span class=s1>&#39;:</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=s1>exit.c:(.text.exit+0x1c): undefined reference to &#39;</span>_exit<span class=err>&#39;</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>collect2:<span class=w> </span>error:<span class=w> </span>ld<span class=w> </span>returned<span class=w> </span><span class=m>1</span><span class=w> </span><span class=nb>exit</span><span class=w> </span>status
</code></pre></div> <p>So with our one-line command above we're invoking the C compiler, the assembler and the linker. The C compiler does most of the menial tasks for us to make life easier for us, but because we're embedded engineers (aren't we?) we MUST be aware of how the compiler, assembler and linker work at a very low level as we generally work with custom systems which we must describe intimately to the tool-chain.</p> <p>So there's a missing <code>_exit</code> symbol. This symbol is reference by the C library we're using. It is in-fact a system call. It's designed to be implemented by the OS. It would be called when a program terminates. In our case, we are our own OS at we're the only thing running, and in fact we will never exit so we do not need to really worry about it. System calls can be blank, they just merely need to be provided in order for the linker to resolve the symbol.</p> <p>So the C library has a requirement of system calls. Sometimes these are already implemented as blank functions, or implemented for fixed functionality. For a list of system calls see the <a href=http://sourceware.org/newlib/libc.html#Stubs>newlib documentation on system calls</a>. Newlib is an open source, and lightweight C library which can be compiled in many different flavours.</p> <p>The C library is what provides all of the C functionality found in standard C header files such as <code>stdio.h</code>, <code>stlib.h</code>, <code>string.h</code>, etc.</p> <p>At this point I want to note that the standard Hello World example won't work here without an OS, and it is exactly unimplemented system calls that prevent it from being our first example. The lowest part of <code>printf(...)</code> includes a write function <code>write</code> - this function is used by all of the functions in the C library that need to write to a file. In the case of printf, it needs to write to the file stdout. Generally when an OS is running stdout produces output visible on a screen which can then be piped to another file system file by the OS. Without an OS, stdout generally prints to a UART to so that you can see program output on a remote screen such as a PC running a terminal program. We will discuss write implementations later on in the tutorial series, let's move on...</p> <p>The easiest way to fix the link problem is to provide a minimal exit function to satisfy the linker. As it is never going to be used, all we need to do is shut the linker up and let it resolve <code>_exit</code>. So now, again with the <code>build.sh</code> script in <code>armc-01</code> we can compile the next version of the code, <code>part-1/armc-01.c</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=p>{</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=p>}</span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=kt>void</span><span class=w> </span><span class=nf>exit</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>code</span><span class=p>)</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=p>{</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=w>        </span><span class=p>;</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=p>}</span>
</code></pre></div> <blockquote> <p><strong>NOTE:</strong> In case you're wondering, the C compiler prefixes an underscore to the generated symbols for functions, so we don't include an underscore, otherwise we'd end up with a function that the linker sees as <code>__exit</code>. If we were writing this in an assembler file, we'd have to include the underscore prefix ourselves.</p> </blockquote> <p>As we can see, compilation is successful and we get a <code>kernel*.elf</code> file generated by the compiler. Currently, that elf file is 37k.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>part-1/armc-01<span class=w> </span>$<span class=w> </span>./build.sh<span class=w> </span>rpi3
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>arm-none-eabi-gcc<span class=w> </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>    </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>    </span>-mcpu<span class=o>=</span>cortex-a53<span class=w> </span><span class=se>\</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>    </span>armc-01.c<span class=w> </span><span class=se>\</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=w>    </span>-o<span class=w> </span>kernel.armc-01.rpi3.elf
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>part-1/armc-01<span class=w> </span>$<span class=w> </span>ls<span class=w> </span>-lh
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>total<span class=w> </span>16K
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a>-rw-r--r--<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>  </span><span class=m>366</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>00</span>:19<span class=w> </span>armc-01.c
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w> </span><span class=m>2</span>.3K<span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>00</span>:45<span class=w> </span>build.sh
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>  </span>36K<span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>00</span>:45<span class=w> </span>kernel.armc-01.rpi3.elf
</code></pre></div> <p>It's important to have an infinite loop in the exit function. In the C library, which is not intended to be used with an operating system (hence <code>arm-NONE-eabi-*</code>), <code>_exit</code> is marked as being noreturn. We must make sure it doesn't return otherwise we will get a warning about it. The prototype for <code>_exit</code> always includes an exit code int too. Yes, that's a bit oxymoronic!</p> <p>Now using the same build command above we get a clean build! Yay! But there is really a problem, in order to provide a system underneath the C library we will have to provide linker scripts and our own C Startup code. In order to skip that initially and to simply get up and running we'll just use GCC's option not to include any of the C startup routines, which excludes the need for exit too.</p> <p>The GCC options for that is <code>-nostartfiles</code></p> <h2 id=getting-to-know-the-processor>Getting to Know the Processor<a class=headerlink href=#getting-to-know-the-processor title="Permanent link">&para;</a></h2> <p>As in the Cambridge tutorials we will copy their initial example of illuminating an LED in order to know that our code is running correctly. This is nearly always the embedded developer's "Hello World!". Usually we'll blink the LED to make sure code is running and to know we're getting clocks at the speed we think we should.</p> <h3 id=raspberry-pi-boot-process>Raspberry-Pi Boot Process<a class=headerlink href=#raspberry-pi-boot-process title="Permanent link">&para;</a></h3> <p>First, let's have a look at how a Raspberry-Pi processor boots. The BCM2385 from Broadcom includes two processors that we should know about, one is a Videocore&trade; GPU which is why the Raspberry-Pi makes such a good media-centre and the other is the ARM core which runs the operating system. Both of these processors share the peripheral bus and also have to share some interrupt resources. Although in this case, share means that some interrupt sources are not available to the ARM processor because they are already taken by the GPU.</p> <p>The GPU starts running at reset or power on and includes code to read the first FAT partition of the SD Card on the MMC bus. It searches for and loads a file called bootcode.bin into memory and starts execution of that code. The bootcode.bin bootloader in turn searches the SD card for a file called start.elf and a config.txt file to set various kernel settings before searching the SD card again for a kernel.img file which it then loads into memory at a specific address (0x8000) and starts the ARM processor executing at that memory location. The GPU is now up and running and the ARM will start to come up using the code contained in kernel.img. The start.elf file contains the code that runs on the GPU to provide most of the requirements of OpenGL, etc.</p> <p>Therefore in order to boot your own code, you need to firstly compile your code to an executable and name it kernel.img, and put it onto a FAT formatted SD Card, which has the GPU bootloader (bootcode.bin, and start.elf) on it as well. The latest Raspberry-Pi firmware is available on <a href=https://github.com/raspberrypi/firmware>GitHub</a>. The bootloader is located under the <a href=https://github.com/raspberrypi/firmware/tree/master/boot>boot sub-directory</a>. The rest of the firmware provided is closed-binary video drivers. They are compiled for use under Linux so that accelerated graphics drivers are available. As we're not using Linux these files are of no use to us, only the bootloader firmware is.</p> <p>All this means that the processor is already up and running when it starts to run our code. Clock sources and PLL settings are already decided and programmed in the bootloader which alleviates that problem from us. We get to just start messing with the devices registers from an already running core. This is something I'm not that used too, normally the first thing in my code would be setting up correct clock and PLL settings to initialise the processor, but the GPU has setup the basic clocking scheme for us.</p> <p>The first thing we will need to set up is the GPIO controller. There are no drivers we can rely on as there is no OS running, all the bootloader has done is boot the processor into a working state, ready to start loading the OS.</p> <p>You'll need to get the <a href=http://www.raspberrypi.org/wp-content/uploads/2012/02/BCM2835-ARM-Peripherals.pdf>Raspberry-Pi BCM2835 peripherals datahsheet</a>, and make sure you pay attention to the <a href=https://elinux.org/BCM2835_datasheet_errata>errata</a> for that too as it's not perfect. This gives us the information we require to control the IO peripherals of the BCM2835. I'll guide us through using the GPIO peripheral - there are as always some gotcha's:</p> <p>The Raspberry-Pi 2B 1.2 uses the BMC2837 and so you'll want to get the <a href=https://web.stanford.edu/class/cs140e/docs/BCM2837-ARM-Peripherals.pdf>Raspberry-Pi BCM2837 peripherals datahsheet</a>.</p> <blockquote> <p><strong>NOTE:</strong> The 2837 peripherals document is just a modified version of the original 2835 document with the addresses updated to suit the 2837's base peripheral address. See <a href=https://github.com/raspberrypi/documentation/issues/325>rpi issue 325</a> for further details.</p> </blockquote> <p>We'll be using the GPIO peripheral, and it would therefore be natural to jump straight to that documentation and start writing code, but we need to first read some of the 'basic' information about the processor. The important bit to note is the virtual address information. On page 5 of the BCM2835 peripherals page we see an IO map for the processor. Again, as embedded engineers we must have the IO map to know how to address peripherals on the processor and in some cases how to arrange our linker scripts when there are multiple address spaces.</p> <p><img alt="ARM Virtual addresses" src=/img/bare-metal-programming-in-c/arm-c-virtual-addresses.jpg></p> <p>The VC CPU Bus addresses relate to the Broadcom Video Core CPU. Although the Video Core CPU is what bootloads from the SD Card, execution is handed over to the ARM core by the time our <code>kernel.img</code> code is called. So we're not interested in the VC CPU Bus addresses.</p> <p>The ARM Physical addresses is the processors raw IO map when the ARM Memory Management Unit (MMU) is not being used. If the MMU is being used, the virtual address space is what what we'd be interested in.</p> <p>Before an OS kernel is running, the MMU is also not running as it has not been initialised and the core is running in kernel mode. Addresses on the bus are therefore accessed via their ARM Physical Address. We can see from the IO map that the VC CPU Address <code>0x7E000000</code> is mapped to ARM Physical Address <code>0x20000000</code> for the original Raspberry Pi. This is important!</p> <p>If you read the two peripheral datasheets carefully you'll see a subtle difference in them, notably , the Raspberry-Pi 2 has the ARM IO base set to <code>0x3F000000</code> instead of the original <code>0x20000000</code> of the original Raspberry-Pi. Unfortunately for us software engineers the Raspberry-Pi foundation don't appear to be good at securing the documentation we need, in fact, their <a href="http://www.raspberrypi.org/forums/viewtopic.php?f=72&t=98400">attitude suggests</a> they think we're magicians and don't actually need any. What a shame! Please if you're a member of the forum, campaign for more documentation. As engineers, especially in industry we wouldn't accept this from a manufacturer, we'd go elsewhere! In fact, we did at my work and use the TI Cortex A8 from the Beaglebone Black, a very good and well documented SoC!</p> <p>Anyway, the base address can be gleaned from searching for uboot patches. The Raspberry Pi 2 uses a BCM2836 so we can search for that and u-boot and we come along a <a href=http://lists.denx.de/pipermail/u-boot/2015-February/204483.html>patch for supporting the Raspberry-Pi 2</a>.</p> <p>Further on in the manual we come across the GPIO peripheral section of the manual (Chapter 6, page 89).</p> <p>RPi4 has the peripheral base mapped to <code>0xFE000000</code>. The peripheral address space looks to be laid out the same as the previous pis.</p> <h2 id=visual-output-and-running-code>Visual Output and Running Code<a class=headerlink href=#visual-output-and-running-code title="Permanent link">&para;</a></h2> <p>Finally, let's get on and see some of our code running on the Raspberry-Pi. We'll continue with using the first example of the Cambridge tutorials by lighting the OK LED on the Raspberry-Pi board.</p> <p>The GPIO peripheral has a base address in the BCM2835 manual at <code>0x7E200000</code>. We know from getting to know our processor that this translates to an ARM Physical Address of <code>0x20200000</code> (<code>0x3F200000</code> for RPI2 and RPI3, and <code>0xFE200000</code> for RPI4). This is the first register in the GPIO peripheral register set, the <code>GPIO Function Select 0</code> register.</p> <p>In order to use an IO pin, we need to configure the GPIO peripheral. From the <a href=http://www.raspberrypi.org/wp-content/uploads/2012/10/Raspberry-Pi-R2.0-Schematics-Issue2.2_027.pdf>Raspberry-Pi schematic diagrams</a> the OK LED is wired to the GPIO16 line (Sheet 2, B5) . The LED is wired active LOW - this is fairly standard practice. It means to turn the LED on we need to output a 0 (the pin is connected to 0V by the processor) and to turn it off we output a 1 (the pin is connected to VDD by the processor).</p> <p>Unfortunately, again, lack of documentation is rife and we don't have schematics for the Raspberry-Pi 2 or plus models! This is important because the GPIO lines were re-jigged and as Florin has noted in the comments section, the Raspberry Pi Plus configuration has the LED on GPIO47, so I've added the changes in brackets below for the RPI B+ models (Which includes the RPI 2).</p> <p>Back to the processor manual and we see that the first thing we need to do is set the GPIO pin to an output. This is done by setting the function of GPIO16 (GPIO47 RPI+) to an output.</p> <p>Bits 18 to 20 in the <code>GPIO Function Select 1</code> register control the GPIO16 pin.</p> <p>Bits 21 to 23 in the <code>GPIO Function Select 4</code> register control the GPIO47 pin. (RPI B+)</p> <p>Bits 27 to 29 in the <code>GPIO Function Select 2</code> register control the GPIO29 pin. (RPI3 B+) GPIO42 pin. (RPI4)</p> <p>In C, we will generate a pointer to the register and use the pointer to write a value into the register. We will mark the register as volatile so that the compiler explicitly does what I tell it to. If we do not mark the register as volatile, the compiler is free to see that we do not access this register again and so to all intents and purposes the data we write will not be used by the program and the optimiser is free to throw away the write because it has no effect.</p> <p>The effect however is definitely required, but is only externally visible (the mode of the GPIO pin changes). We inform the compiler through the volatile keyword to not take anything for granted on this variable and to simply do as I say with it:</p> <p>We will use pre-processor definitions to change the base address of the GPIO peripheral depending on what RPI model is being targeted.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=cp>#if defined( RPI0 ) || defined( RPI1 )</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0x20200000UL</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=cp>#elif defined( RPI2 ) || defined( RPI3 )</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0x3F200000UL</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=cp>#elif defined( RPI4 )</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0xFE200000UL</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=cp>#else</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>    </span><span class=cp>#error Unknown RPI Model!</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=cp>#endif</span>
</code></pre></div> <p>In order to set GPIO16 as an output then we need to write a value of 1 in the relevant bits of the function select register. Here we can rely on the fact that this register is set to 0 after a reset and so all we need to do is set:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=cm>/* Assign the address of the GPIO peripheral (Using ARM Physical Address) */</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=n>gpio</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>unsigned</span><span class=w> </span><span class=kt>int</span><span class=o>*</span><span class=p>)</span><span class=n>GPIO_BASE</span><span class=p>;</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=n>gpio</span><span class=p>[</span><span class=n>LED_GPFSEL</span><span class=p>]</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>LED_GPFBIT</span><span class=p>);</span>
</code></pre></div> <p>This code looks a bit messy, but we will tidy up and optimise later on. For now we just want to get to the point where we can light an LED and understand why it is lit!</p> <p>The ARM GPIO peripherals have an interesting way of doing IO. It's actually a bit different to most other processor IO implementations. There is a SET register and a CLEAR register. Writing 1 to any bits in the SET register will SET the corresponding GPIO pins to 1 (logic high), and writing 1 to any bits in the CLEAR register will CLEAR the corresponding GPIO pins to 0 (logic low). There are reasons for this implementation over a register where each bit is a pin and the bit value directly relates to the pins output level, but it's beyond the scope of this tutorial.</p> <p>So in order to light the LED we need to output a 0. We need to write a 1 to bit 16 in the CLEAR register:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=o>*</span><span class=n>gpio_clear</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=o>&lt;&lt;</span><span class=mi>16</span><span class=p>);</span>
</code></pre></div> <p>Putting what we've learnt into the minimal example above gives us a program that compiles and links into an executable which should provide us with a Raspberry-Pi that lights the OK LED when it is powered. Here's the complete code we'll compile <code>part-1/armc-02</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=cm>/* The base address of the GPIO peripheral (ARM Physical Address) */</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=cp>#if defined( RPI0 ) || defined( RPI1 )</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0x20200000UL</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=cp>#elif defined( RPI2 ) || defined( RPI3 )</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0x3F200000UL</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=cp>#elif defined( RPI4 )</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>    </span><span class=cm>/* This comes from the linux source code:</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=cm>       https://github.com/raspberrypi/linux/blob/rpi-4.19.y/arch/arm/boot/dts/bcm2838.dtsi */</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>    </span><span class=cp>#define GPIO_BASE       0xFE200000UL</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=cp>#else</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=w>    </span><span class=cp>#error Unknown RPI Model!</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=cp>#endif</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=cm>/* TODO: Expand this to RPi4 as necessary */</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=cp>#if defined( RPIBPLUS ) || defined( RPI2 )</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>    </span><span class=cp>#define LED_GPFSEL      GPIO_GPFSEL4</span>
<a id=__codelineno-19-17 name=__codelineno-19-17 href=#__codelineno-19-17></a><span class=w>    </span><span class=cp>#define LED_GPFBIT      21</span>
<a id=__codelineno-19-18 name=__codelineno-19-18 href=#__codelineno-19-18></a><span class=w>    </span><span class=cp>#define LED_GPSET       GPIO_GPSET1</span>
<a id=__codelineno-19-19 name=__codelineno-19-19 href=#__codelineno-19-19></a><span class=w>    </span><span class=cp>#define LED_GPCLR       GPIO_GPCLR1</span>
<a id=__codelineno-19-20 name=__codelineno-19-20 href=#__codelineno-19-20></a><span class=w>    </span><span class=cp>#define LED_GPIO_BIT    15</span>
<a id=__codelineno-19-21 name=__codelineno-19-21 href=#__codelineno-19-21></a><span class=cp>#elif defined( RPI4 )</span>
<a id=__codelineno-19-22 name=__codelineno-19-22 href=#__codelineno-19-22></a><span class=w>    </span><span class=cm>/* The RPi4 model has the ACT LED attached to GPIO 42</span>
<a id=__codelineno-19-23 name=__codelineno-19-23 href=#__codelineno-19-23></a><span class=cm>       https://github.com/raspberrypi/linux/blob/rpi-4.19.y/arch/arm/boot/dts/bcm2838-rpi-4-b.dts */</span>
<a id=__codelineno-19-24 name=__codelineno-19-24 href=#__codelineno-19-24></a><span class=w>    </span><span class=cp>#define LED_GPFSEL      GPIO_GPFSEL4</span>
<a id=__codelineno-19-25 name=__codelineno-19-25 href=#__codelineno-19-25></a><span class=w>    </span><span class=cp>#define LED_GPFBIT      6</span>
<a id=__codelineno-19-26 name=__codelineno-19-26 href=#__codelineno-19-26></a><span class=w>    </span><span class=cp>#define LED_GPSET       GPIO_GPSET1</span>
<a id=__codelineno-19-27 name=__codelineno-19-27 href=#__codelineno-19-27></a><span class=w>    </span><span class=cp>#define LED_GPCLR       GPIO_GPCLR1</span>
<a id=__codelineno-19-28 name=__codelineno-19-28 href=#__codelineno-19-28></a><span class=w>    </span><span class=cp>#define LED_GPIO_BIT    10</span>
<a id=__codelineno-19-29 name=__codelineno-19-29 href=#__codelineno-19-29></a><span class=cp>#else</span>
<a id=__codelineno-19-30 name=__codelineno-19-30 href=#__codelineno-19-30></a><span class=w>    </span><span class=cp>#define LED_GPFSEL      GPIO_GPFSEL1</span>
<a id=__codelineno-19-31 name=__codelineno-19-31 href=#__codelineno-19-31></a><span class=w>    </span><span class=cp>#define LED_GPFBIT      18</span>
<a id=__codelineno-19-32 name=__codelineno-19-32 href=#__codelineno-19-32></a><span class=w>    </span><span class=cp>#define LED_GPSET       GPIO_GPSET0</span>
<a id=__codelineno-19-33 name=__codelineno-19-33 href=#__codelineno-19-33></a><span class=w>    </span><span class=cp>#define LED_GPCLR       GPIO_GPCLR0</span>
<a id=__codelineno-19-34 name=__codelineno-19-34 href=#__codelineno-19-34></a><span class=w>    </span><span class=cp>#define LED_GPIO_BIT    16</span>
<a id=__codelineno-19-35 name=__codelineno-19-35 href=#__codelineno-19-35></a><span class=cp>#endif</span>
<a id=__codelineno-19-36 name=__codelineno-19-36 href=#__codelineno-19-36></a>
<a id=__codelineno-19-37 name=__codelineno-19-37 href=#__codelineno-19-37></a><span class=cp>#define GPIO_GPFSEL0    0</span>
<a id=__codelineno-19-38 name=__codelineno-19-38 href=#__codelineno-19-38></a><span class=cp>#define GPIO_GPFSEL1    1</span>
<a id=__codelineno-19-39 name=__codelineno-19-39 href=#__codelineno-19-39></a><span class=cp>#define GPIO_GPFSEL2    2</span>
<a id=__codelineno-19-40 name=__codelineno-19-40 href=#__codelineno-19-40></a><span class=cp>#define GPIO_GPFSEL3    3</span>
<a id=__codelineno-19-41 name=__codelineno-19-41 href=#__codelineno-19-41></a><span class=cp>#define GPIO_GPFSEL4    4</span>
<a id=__codelineno-19-42 name=__codelineno-19-42 href=#__codelineno-19-42></a><span class=cp>#define GPIO_GPFSEL5    5</span>
<a id=__codelineno-19-43 name=__codelineno-19-43 href=#__codelineno-19-43></a>
<a id=__codelineno-19-44 name=__codelineno-19-44 href=#__codelineno-19-44></a><span class=cp>#define GPIO_GPSET0     7</span>
<a id=__codelineno-19-45 name=__codelineno-19-45 href=#__codelineno-19-45></a><span class=cp>#define GPIO_GPSET1     8</span>
<a id=__codelineno-19-46 name=__codelineno-19-46 href=#__codelineno-19-46></a>
<a id=__codelineno-19-47 name=__codelineno-19-47 href=#__codelineno-19-47></a><span class=cp>#define GPIO_GPCLR0     10</span>
<a id=__codelineno-19-48 name=__codelineno-19-48 href=#__codelineno-19-48></a><span class=cp>#define GPIO_GPCLR1     11</span>
<a id=__codelineno-19-49 name=__codelineno-19-49 href=#__codelineno-19-49></a>
<a id=__codelineno-19-50 name=__codelineno-19-50 href=#__codelineno-19-50></a><span class=cp>#define GPIO_GPLEV0     13</span>
<a id=__codelineno-19-51 name=__codelineno-19-51 href=#__codelineno-19-51></a><span class=cp>#define GPIO_GPLEV1     14</span>
<a id=__codelineno-19-52 name=__codelineno-19-52 href=#__codelineno-19-52></a>
<a id=__codelineno-19-53 name=__codelineno-19-53 href=#__codelineno-19-53></a><span class=cp>#define GPIO_GPEDS0     16</span>
<a id=__codelineno-19-54 name=__codelineno-19-54 href=#__codelineno-19-54></a><span class=cp>#define GPIO_GPEDS1     17</span>
<a id=__codelineno-19-55 name=__codelineno-19-55 href=#__codelineno-19-55></a>
<a id=__codelineno-19-56 name=__codelineno-19-56 href=#__codelineno-19-56></a><span class=cp>#define GPIO_GPREN0     19</span>
<a id=__codelineno-19-57 name=__codelineno-19-57 href=#__codelineno-19-57></a><span class=cp>#define GPIO_GPREN1     20</span>
<a id=__codelineno-19-58 name=__codelineno-19-58 href=#__codelineno-19-58></a>
<a id=__codelineno-19-59 name=__codelineno-19-59 href=#__codelineno-19-59></a><span class=cp>#define GPIO_GPFEN0     22</span>
<a id=__codelineno-19-60 name=__codelineno-19-60 href=#__codelineno-19-60></a><span class=cp>#define GPIO_GPFEN1     23</span>
<a id=__codelineno-19-61 name=__codelineno-19-61 href=#__codelineno-19-61></a>
<a id=__codelineno-19-62 name=__codelineno-19-62 href=#__codelineno-19-62></a><span class=cp>#define GPIO_GPHEN0     25</span>
<a id=__codelineno-19-63 name=__codelineno-19-63 href=#__codelineno-19-63></a><span class=cp>#define GPIO_GPHEN1     26</span>
<a id=__codelineno-19-64 name=__codelineno-19-64 href=#__codelineno-19-64></a>
<a id=__codelineno-19-65 name=__codelineno-19-65 href=#__codelineno-19-65></a><span class=cp>#define GPIO_GPLEN0     28</span>
<a id=__codelineno-19-66 name=__codelineno-19-66 href=#__codelineno-19-66></a><span class=cp>#define GPIO_GPLEN1     29</span>
<a id=__codelineno-19-67 name=__codelineno-19-67 href=#__codelineno-19-67></a>
<a id=__codelineno-19-68 name=__codelineno-19-68 href=#__codelineno-19-68></a><span class=cp>#define GPIO_GPAREN0    31</span>
<a id=__codelineno-19-69 name=__codelineno-19-69 href=#__codelineno-19-69></a><span class=cp>#define GPIO_GPAREN1    32</span>
<a id=__codelineno-19-70 name=__codelineno-19-70 href=#__codelineno-19-70></a>
<a id=__codelineno-19-71 name=__codelineno-19-71 href=#__codelineno-19-71></a><span class=cp>#define GPIO_GPAFEN0    34</span>
<a id=__codelineno-19-72 name=__codelineno-19-72 href=#__codelineno-19-72></a><span class=cp>#define GPIO_GPAFEN1    35</span>
<a id=__codelineno-19-73 name=__codelineno-19-73 href=#__codelineno-19-73></a>
<a id=__codelineno-19-74 name=__codelineno-19-74 href=#__codelineno-19-74></a><span class=cp>#define GPIO_GPPUD      37</span>
<a id=__codelineno-19-75 name=__codelineno-19-75 href=#__codelineno-19-75></a><span class=cp>#define GPIO_GPPUDCLK0  38</span>
<a id=__codelineno-19-76 name=__codelineno-19-76 href=#__codelineno-19-76></a><span class=cp>#define GPIO_GPPUDCLK1  39</span>
<a id=__codelineno-19-77 name=__codelineno-19-77 href=#__codelineno-19-77></a>
<a id=__codelineno-19-78 name=__codelineno-19-78 href=#__codelineno-19-78></a><span class=cm>/** GPIO Register set */</span>
<a id=__codelineno-19-79 name=__codelineno-19-79 href=#__codelineno-19-79></a><span class=k>volatile</span><span class=w> </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>int</span><span class=o>*</span><span class=w> </span><span class=n>gpio</span><span class=p>;</span>
<a id=__codelineno-19-80 name=__codelineno-19-80 href=#__codelineno-19-80></a>
<a id=__codelineno-19-81 name=__codelineno-19-81 href=#__codelineno-19-81></a><span class=cm>/** Simple loop variable */</span>
<a id=__codelineno-19-82 name=__codelineno-19-82 href=#__codelineno-19-82></a><span class=k>volatile</span><span class=w> </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tim</span><span class=p>;</span>
<a id=__codelineno-19-83 name=__codelineno-19-83 href=#__codelineno-19-83></a>
<a id=__codelineno-19-84 name=__codelineno-19-84 href=#__codelineno-19-84></a><span class=cm>/** Main function - we&#39;ll never return from here */</span>
<a id=__codelineno-19-85 name=__codelineno-19-85 href=#__codelineno-19-85></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=w> </span><span class=n>__attribute__</span><span class=p>((</span><span class=kr>naked</span><span class=p>));</span>
<a id=__codelineno-19-86 name=__codelineno-19-86 href=#__codelineno-19-86></a><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
<a id=__codelineno-19-87 name=__codelineno-19-87 href=#__codelineno-19-87></a><span class=p>{</span>
<a id=__codelineno-19-88 name=__codelineno-19-88 href=#__codelineno-19-88></a><span class=w>    </span><span class=cm>/* Assign the address of the GPIO peripheral (Using ARM Physical Address) */</span>
<a id=__codelineno-19-89 name=__codelineno-19-89 href=#__codelineno-19-89></a><span class=w>    </span><span class=n>gpio</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>unsigned</span><span class=w> </span><span class=kt>int</span><span class=o>*</span><span class=p>)</span><span class=n>GPIO_BASE</span><span class=p>;</span>
<a id=__codelineno-19-90 name=__codelineno-19-90 href=#__codelineno-19-90></a>
<a id=__codelineno-19-91 name=__codelineno-19-91 href=#__codelineno-19-91></a><span class=w>    </span><span class=cm>/* Write 1 to the GPIO16 init nibble in the Function Select 1 GPIO</span>
<a id=__codelineno-19-92 name=__codelineno-19-92 href=#__codelineno-19-92></a><span class=cm>       peripheral register to enable GPIO16 as an output */</span>
<a id=__codelineno-19-93 name=__codelineno-19-93 href=#__codelineno-19-93></a><span class=w>    </span><span class=n>gpio</span><span class=p>[</span><span class=n>LED_GPFSEL</span><span class=p>]</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>LED_GPFBIT</span><span class=p>);</span>
<a id=__codelineno-19-94 name=__codelineno-19-94 href=#__codelineno-19-94></a>
<a id=__codelineno-19-95 name=__codelineno-19-95 href=#__codelineno-19-95></a><span class=w>    </span><span class=cm>/* Never exit as there is no OS to exit to! */</span>
<a id=__codelineno-19-96 name=__codelineno-19-96 href=#__codelineno-19-96></a><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<a id=__codelineno-19-97 name=__codelineno-19-97 href=#__codelineno-19-97></a><span class=w>    </span><span class=p>{</span>
<a id=__codelineno-19-98 name=__codelineno-19-98 href=#__codelineno-19-98></a><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=n>tim</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>tim</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>500000</span><span class=p>;</span><span class=w> </span><span class=n>tim</span><span class=o>++</span><span class=p>)</span>
<a id=__codelineno-19-99 name=__codelineno-19-99 href=#__codelineno-19-99></a><span class=w>            </span><span class=p>;</span>
<a id=__codelineno-19-100 name=__codelineno-19-100 href=#__codelineno-19-100></a>
<a id=__codelineno-19-101 name=__codelineno-19-101 href=#__codelineno-19-101></a><span class=w>        </span><span class=cm>/* Set the LED GPIO pin low ( Turn OK LED on for original Pi, and off</span>
<a id=__codelineno-19-102 name=__codelineno-19-102 href=#__codelineno-19-102></a><span class=cm>           for plus models )*/</span>
<a id=__codelineno-19-103 name=__codelineno-19-103 href=#__codelineno-19-103></a><span class=w>        </span><span class=n>gpio</span><span class=p>[</span><span class=n>LED_GPCLR</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>LED_GPIO_BIT</span><span class=p>);</span>
<a id=__codelineno-19-104 name=__codelineno-19-104 href=#__codelineno-19-104></a>
<a id=__codelineno-19-105 name=__codelineno-19-105 href=#__codelineno-19-105></a><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=n>tim</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>tim</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>500000</span><span class=p>;</span><span class=w> </span><span class=n>tim</span><span class=o>++</span><span class=p>)</span>
<a id=__codelineno-19-106 name=__codelineno-19-106 href=#__codelineno-19-106></a><span class=w>            </span><span class=p>;</span>
<a id=__codelineno-19-107 name=__codelineno-19-107 href=#__codelineno-19-107></a>
<a id=__codelineno-19-108 name=__codelineno-19-108 href=#__codelineno-19-108></a><span class=w>        </span><span class=cm>/* Set the LED GPIO pin high ( Turn OK LED off for original Pi, and on</span>
<a id=__codelineno-19-109 name=__codelineno-19-109 href=#__codelineno-19-109></a><span class=cm>           for plus models )*/</span>
<a id=__codelineno-19-110 name=__codelineno-19-110 href=#__codelineno-19-110></a><span class=w>        </span><span class=n>gpio</span><span class=p>[</span><span class=n>LED_GPSET</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>LED_GPIO_BIT</span><span class=p>);</span>
<a id=__codelineno-19-111 name=__codelineno-19-111 href=#__codelineno-19-111></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-19-112 name=__codelineno-19-112 href=#__codelineno-19-112></a><span class=p>}</span>
</code></pre></div> <p>We now compile with the no start files option too:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a>part-1/armc-02<span class=w> </span>$<span class=w> </span>./build.sh<span class=w> </span>rpi3
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>arm-none-eabi-gcc<span class=w> </span>-nostartfiles<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=w>    </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=w>    </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=w>    </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=w>    </span>-mcpu<span class=o>=</span>cortex-a53<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=w>    </span>armc-02.c<span class=w> </span><span class=se>\</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=w>    </span>-o<span class=w> </span>kernel.armc-02.rpi3.elf
</code></pre></div> <p>The linker gives us a warning, which we'll sort out later, but importantly the linker has resolved the problem for us. This is the warning we'll see and ignore:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a>.../arm-none-eabi/bin/ld:<span class=w> </span>warning:<span class=w> </span>cannot<span class=w> </span>find<span class=w> </span>entry<span class=w> </span>symbol<span class=w> </span>_start<span class=p>;</span><span class=w> </span>defaulting<span class=w> </span>to<span class=w> </span><span class=m>0000000000008000</span>
</code></pre></div> <p>As we can see from the compilation, the standard output is ELF format which is essentially an executable wrapped with information that an OS binary loader may need to know. We need a binary ARM executable that only includes machine code. We can extract this using the objcopy utility:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>arm-none-eabi-objcopy<span class=w> </span>kernel.elf<span class=w> </span>-O<span class=w> </span>binary<span class=w> </span>kernel.img
</code></pre></div> <h3 id=a-quick-note-about-the-elf-format>A quick note about the ELF format<a class=headerlink href=#a-quick-note-about-the-elf-format title="Permanent link">&para;</a></h3> <p><a href=http://en.wikipedia.org/wiki/Executable_and_Linkable_Format>ELF</a> is a file format used by some OS, including Linux which wraps the machine code with meta-data. The meta-data can be useful. In Linux and in fact most OS these days, running an executable doesn't mean the file gets loaded into memory and then the processor starts running from the address at which the file was loaded. There is usually an executable loader which uses formats like ELF to know more about the executable, for example the Function call interface might be different between different executables, this means that code can use different calling conventions which use different registers for different meanings when calling functions within a program. This can determine whether the executable loader will even allow the program to be loaded into memory or not. The ELF format meta-data can also include a list of all of the shared objects (SO, or DLL under Windows) that this executable also needs to have loaded. If any of the required libraries are not available, again the executable loader will not allow the file to be loaded and run.</p> <p>This is all intended (and does) to increase system stability and compatibility.</p> <p>We however, do not have an OS and the bootloader does not have any loader other than a disk read, directly copying the <code>kernel.img</code> file into memory at <code>0x8000</code> which is then where the ARM processor starts execution of machine code. Therefore we need to strip off the ELF meta-data and simply leave just the compiled machine code in the <code>kernel.img</code> file ready for execution.</p> <h3 id=back-to-our-example>Back to our example<a class=headerlink href=#back-to-our-example title="Permanent link">&para;</a></h3> <p>This gives us the <code>kernel.img</code> binary file which should only contain ARM machine code. It should be tens of bytes long. You'll notice that <code>kernel.elf</code> on the otherhand is ~34Kb. Rename the <code>kernel.img</code> on your SD Card to something like old.kernel.img and save your new kernel.img to the SD Card.</p> <p>Booting from this SD Card should now leave the OK LED on permanently. The normal startup is for the OK LED to be on, then extinguish. If it remains extinguished something went wrong with building or linking your program. Otherwise if the LED remains lit, your program has executed successfully.</p> <p>A blinking LED is probably more appropriate to make sure that our code is definitely running. Let's quickly change the code to crudely blink an LED and then we'll look at sorting out the C library issues we had earlier as the C library is far too useful to not have access to it.</p> <p>Compile the code in <code>part-1/armc-03</code>. The code listing is identical to <code>part-1/armc-02</code> but the build scripts use objcopy to convert the ELF formatted binary to a raw binary ready to deploy on the SD card.</p> <p>You can see that a binary image is now in the folder and is a much more sane size for some code that does so little:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>part-1/armc-03<span class=w> </span>$<span class=w> </span>./build.sh<span class=w> </span>rpi3bp
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=w>    </span>arm-none-eabi-gcc<span class=w> </span>-g<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=w>        </span>-nostartfiles<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>        </span>-mfloat-abi<span class=o>=</span>hard<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>        </span>-O0<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>        </span>-DIOBPLUS<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>        </span>-DRPI3<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>        </span>-mfpu<span class=o>=</span>crypto-neon-fp-armv8<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>        </span>-march<span class=o>=</span>armv8-a+crc<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>        </span>-mcpu<span class=o>=</span>cortex-a53<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=w>        </span>armc-03.c<span class=w> </span><span class=se>\</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=w>        </span>-o<span class=w> </span>kernel.armc-03.rpi3bp.elf
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a>.../arm-none-eabi/bin/ld:<span class=w> </span>warning:<span class=w> </span>cannot<span class=w> </span>find<span class=w> </span>entry<span class=w> </span>symbol<span class=w> </span>_start<span class=p>;</span><span class=w> </span>defaulting<span class=w> </span>to<span class=w> </span><span class=m>0000000000008000</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a>arm-none-eabi-objcopy<span class=w> </span>kernel.armc-03.rpi3bp.elf<span class=w> </span>-O<span class=w> </span>binary<span class=w> </span>kernel.img
</code></pre></div> <p>The <code>kernel.img</code> file contains just the ARM machine code and so is just a few hundred bytes.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a>part-1/armc-03<span class=w> </span>$<span class=w> </span>ll
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>total<span class=w> </span><span class=m>28</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>drwxr-xr-x<span class=w> </span><span class=m>2</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>     </span><span class=m>4096</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>01</span>:05<span class=w> </span>./
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a>drwxr-xr-x<span class=w> </span><span class=m>6</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>     </span><span class=m>4096</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>00</span>:19<span class=w> </span>../
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>-rw-r--r--<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>     </span><span class=m>3894</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>00</span>:19<span class=w> </span>armc-03.c
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>     </span><span class=m>2805</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>01</span>:05<span class=w> </span>build.sh*
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w> </span><span class=m>16777216</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>01</span>:05<span class=w> </span>card.armc-03.rpi3bp.img
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>    </span><span class=m>35208</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>01</span>:05<span class=w> </span>kernel.armc-03.rpi3bp.elf*
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>-rwxr-xr-x<span class=w> </span><span class=m>1</span><span class=w> </span>brian<span class=w> </span>brian<span class=w>      </span><span class=m>268</span><span class=w> </span>Sep<span class=w> </span><span class=m>21</span><span class=w> </span><span class=m>01</span>:05<span class=w> </span>kernel.armc-03.rpi3bp.img*
</code></pre></div> <h2 id=generating-sd-cards>Generating SD Cards<a class=headerlink href=#generating-sd-cards title="Permanent link">&para;</a></h2> <p>The next step is how to get this <code>kernel.img</code> file onto an SD Card so we can boot the card and run our newly compiled code.</p> <p>A script, called <code>make_card.sh</code> was run during the <code>build.sh</code> script run. Have a look in the <code>build.sh</code> script to see the call near the end of the script. It does the work of generating an SD Card image that can be written directly to an SD card.</p> <p>The <code>/card/make_card.sh</code> script is worth a look. It can generate a card image without the need to user super user priveleges. It always uses the latest firmware available from the <a href=https://github.com/raspberrypi/firmware>RPi Foundation GitHub repository</a></p> <p>Writing the image to the card can be done using <code>cat</code> so long as you know what the SD Card device is.</p> <p>If you'd rather, you can use the <code>write_card.sh</code> script in the <code>card</code> directory which you can use interactively to select the SD Card.</p> <p>If you prefer to do things manually you can insert the SD Card and then run <code>dmesg | tail</code> to view messages which will show you which device reference was used for the SD Card or else use <code>lsblk</code> to list all of the block devices available.</p> <p><strong>DON'T GET THE SD CARD DEVICE WRONG OR YOU'LL COMPLETELY WIPE OUT ANOTHER DISK!</strong></p> <p>When you know what disk to use, you can simply cat the image to the disk using <code>cat kernel.armc-03.rpibp.img &gt; /dev/sdg</code> for example</p> <h2 id=provided-binaries>Provided Binaries<a class=headerlink href=#provided-binaries title="Permanent link">&para;</a></h2> <p>As this is the first example where code should run and give you a visible output on your RPi, I've included the kernel binaries for each Raspberry-Pi board so that you can load the pre-built binary and see the LED flash before compiling your own kernel to make sure the build process is working for you. After this tutorial, you'll have to build your own binaries!</p> <p>Although the code may appear to be written a little odd, please stick with it! There are reasons why it's written how it is. Now you can experiment a bit from a basic starting point, but beware - automatic variables won't work, and nor will initialised variables because we have no C Run Time support yet.</p> <p>That will be where we start with <a href=http://www.valvers.com/embedded-linux/raspberry-pi/step02-bare-metal-programming-in-c-pt2>Step 2 of Bare metal programming the Raspberry-Pi</a>!</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2002-2020 Brian Sidebotham </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/squidfunk target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://gitter.im/squidfunk/mkdocs-material target=_blank rel=noopener title=gitter.im class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg> </a> <a href=https://hub.docker.com/r/squidfunk/mkdocs-material/ target=_blank rel=noopener title=hub.docker.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg> </a> <a href=https://pypi.org/project/mkdocs-material/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> <a href=https://twitter.com/squidfunk target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.4b2c34cd.min.js></script> </body> </html>